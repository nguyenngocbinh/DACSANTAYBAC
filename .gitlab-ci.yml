# GitLab CI/CD Pipeline for DACSANTAYBAC
# Mirror repository from GitLab to GitHub

stages:
  - deploy

variables:
  GIT_STRATEGY: clone

deploy_to_github:
  stage: deploy
  image: alpine:latest
  before_script:
    - apk add --no-cache git
  script:
    - git config --global user.email "nguyenngocbinhneu@gmail.com"
    - git config --global user.name "Nguyen Ngoc Binh"
    - echo "Cloning repository..."
    - git clone --mirror https://oauth2:$GITLAB_PERSONAL_ACCESS_TOKEN@gitlab.com/nguyenngocbinh/DACSANTAYBAC.git || (echo "Clone failed"; exit 1)
    - cd DACSANTAYBAC.git
    - echo "Adding GitHub remote..."
    - git remote add github https://$GITHUB_TOKEN@github.com/nguyenngocbinh/DACSANTAYBAC.git
    - echo "Pushing to GitHub..."
    - git push --mirror github || (echo "Push failed"; exit 1)
    - echo "‚úÖ Successfully mirrored to GitHub!"
    - echo "üåê Website: https://nguyenngocbinh.github.io/DACSANTAYBAC/"
    - echo "üë®‚Äçüíº Admin Panel: https://nguyenngocbinh.github.io/DACSANTAYBAC/admin.html"
  only:
    - main
