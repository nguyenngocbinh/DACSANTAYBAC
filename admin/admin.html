<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üåø Admin Panel - ƒê·∫∑c S·∫£n T√¢y B·∫Øc (Enhanced)</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .admin-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* Login Modal */
        .login-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        
        .login-content {
            background: white;
            padding: 2rem;
            border-radius: 15px;
            width: 400px;
            max-width: 90%;
            box-shadow: 0 15px 35px rgba(0,0,0,0.2);
        }
        
        .login-header {
            text-align: center;
            margin-bottom: 2rem;
        }
        
        .login-header h2 {
            color: #27ae60;
            margin-bottom: 0.5rem;
        }
        
        .form-group {
            margin-bottom: 1.5rem;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            color: #333;
            font-weight: 600;
        }
        
        .form-group input, .form-group textarea, .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e1e8ed;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        
        .form-group input:focus, .form-group textarea:focus, .form-group select:focus {
            outline: none;
            border-color: #27ae60;
        }
        
        .btn {
            width: 100%;
            padding: 12px;
            background: #27ae60;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            transition: background 0.3s;
        }
        
        .btn:hover {
            background: #219a52;
        }
        
        .btn-danger {
            background: #dc3545;
        }
        
        .btn-danger:hover {
            background: #c82333;
        }
        
        .btn-primary {
            background: #007bff;
        }
        
        .btn-primary:hover {
            background: #0056b3;
        }
        
        .btn-success {
            background: #28a745;
        }
        
        .btn-success:hover {
            background: #1e7e34;
        }
        
        .btn-info {
            background: #17a2b8;
        }
        
        .btn-info:hover {
            background: #117a8b;
        }
        
        .btn-secondary {
            background: #6c757d;
        }
        
        .btn-secondary:hover {
            background: #545b62;
        }
        }
        
        .btn-primary:hover {
            background: #0056b3;
        }
        
        .btn-warning {
            background: #ffc107;
            color: #212529;
        }
        
        .btn-warning:hover {
            background: #e0a800;
        }
        
        /* Dashboard */
        .dashboard {
            display: none;
        }
        
        .dashboard.active {
            display: block;
        }
        
        .dashboard-header {
            background: white;
            padding: 2rem;
            border-radius: 15px;
            margin-bottom: 2rem;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .dashboard-header h1 {
            color: #27ae60;
            margin-bottom: 1rem;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }
        
        .stat-card {
            background: white;
            padding: 1.5rem;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            text-align: center;
        }
        
        .stat-card i {
            font-size: 2rem;
            color: #27ae60;
            margin-bottom: 1rem;
        }
        
        .stat-card h3 {
            color: #333;
            margin-bottom: 0.5rem;
        }
        
        .stat-card p {
            color: #666;
            font-size: 1.2rem;
        }
        
        /* Products Section */
        .products-section {
            background: white;
            padding: 2rem;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }
        
        .search-filter {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }
        
        .search-filter input, .search-filter select {
            padding: 10px;
            border: 2px solid #e1e8ed;
            border-radius: 6px;
            font-size: 14px;
        }
        
        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 1.5rem;
        }
        
        .product-card {
            background: #f8f9fa;
            padding: 1.5rem;
            border-radius: 10px;
            border: 1px solid #e9ecef;
            transition: transform 0.2s;
        }
        
        .product-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .product-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }
        
        .product-header h4 {
            color: #333;
            font-size: 1.1rem;
        }
        
        .product-emoji {
            font-size: 2rem;
        }
        
        .product-image-section {
            margin-bottom: 1rem;
            text-align: center;
        }
        
        .product-image-preview {
            width: 80px;
            height: 80px;
            background: #e9ecef;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1rem;
            font-size: 2.5rem;
            transition: transform 0.2s;
        }
        
        .product-image-preview:hover {
            transform: scale(1.1);
        }
        
        .image-url-display {
            font-size: 0.8rem;
            color: #666;
            word-break: break-all;
            max-height: 40px;
            overflow: hidden;
        }
        
        .product-info {
            margin-bottom: 1rem;
        }
        
        .product-info p {
            color: #666;
            margin: 0.25rem 0;
            font-size: 0.9rem;
        }
        
        .price-section {
            background: #e8f5e8;
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
        }
        
        .price-display {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
        }
        
        .price-display span {
            font-weight: bold;
        }
        
        .original-price {
            color: #666;
            text-decoration: line-through;
        }
        
        .current-price {
            color: #27ae60;
            font-size: 1.1rem;
        }
        
        .price-edit {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
        }
        
        .price-input {
            flex: 1;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        
        .product-actions {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }
        
        .product-actions-full {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 0.5rem;
        }
        
        .btn-sm {
            padding: 6px 12px;
            font-size: 12px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .btn-edit {
            background: #17a2b8;
            color: white;
        }
        
        .btn-edit:hover {
            background: #138496;
        }
        
        .btn-reset {
            background: #ffc107;
            color: #212529;
        }
        
        .btn-reset:hover {
            background: #e0a800;
        }
        
        .btn-image {
            background: #6f42c1;
            color: white;
        }
        
        .btn-image:hover {
            background: #5a32a3;
        }
        
        /* Edit Modal */
        .edit-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1001;
        }
        
        .edit-modal.active {
            display: flex;
        }
        
        .edit-content {
            background: white;
            padding: 2rem;
            border-radius: 15px;
            width: 500px;
            max-width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 15px 35px rgba(0,0,0,0.2);
        }
        
        .edit-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }
        
        .edit-header h3 {
            color: #27ae60;
        }
        
        .close-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #666;
        }
        
        .close-btn:hover {
            color: #333;
        }
        
        .emoji-picker {
            display: grid;
            grid-template-columns: repeat(8, 1fr);
            gap: 0.5rem;
            margin: 1rem 0;
            max-height: 200px;
            overflow-y: auto;
            padding: 1rem;
            border: 2px solid #e1e8ed;
            border-radius: 8px;
        }
        
        .emoji-option {
            padding: 0.5rem;
            border: none;
            background: #f8f9fa;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1.5rem;
            transition: background 0.2s;
        }
        
        .emoji-option:hover {
            background: #e9ecef;
        }
        
        .emoji-option.selected {
            background: #27ae60;
            color: white;
        }
        
        /* Status Messages */
        .status-message {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 1rem;
            border-radius: 8px;
            color: white;
            font-weight: bold;
            z-index: 1002;
            transform: translateX(400px);
            transition: transform 0.3s;
            max-width: 300px;
        }
        
        .status-message.show {
            transform: translateX(0);
        }
        
        .status-message.success {
            background: #28a745;
        }
        
        .status-message.error {
            background: #dc3545;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .admin-container {
                padding: 10px;
            }
            
            .products-grid {
                grid-template-columns: 1fr;
            }
            
            .search-filter {
                flex-direction: column;
            }
            
            .product-actions {
                grid-template-columns: 1fr;
            }
            
            .product-actions-full {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="admin-container">
        <!-- Login Modal -->
        <div id="loginModal" class="login-modal">
            <div class="login-content">
                <div class="login-header">
                    <h2><i class="fas fa-shield-alt"></i> Admin Login</h2>
                    <p>ƒêƒÉng nh·∫≠p ƒë·ªÉ qu·∫£n l√Ω s·∫£n ph·∫©m</p>
                </div>
                <form id="loginForm">
                    <div class="form-group">
                        <label><i class="fas fa-user"></i> T√™n ƒëƒÉng nh·∫≠p:</label>
                        <input type="text" id="username" placeholder="admin" required>
                    </div>
                    <div class="form-group">
                        <label><i class="fas fa-lock"></i> M·∫≠t kh·∫©u:</label>
                        <input type="password" id="password" placeholder="admin123" required>
                    </div>
                    <button type="submit" class="btn">
                        <i class="fas fa-sign-in-alt"></i> ƒêƒÉng Nh·∫≠p
                    </button>
                </form>
                <div style="text-align: center; margin-top: 1rem; color: #666; font-size: 0.9rem;">
                    <i class="fas fa-info-circle"></i> T√†i kho·∫£n m·∫∑c ƒë·ªãnh: admin / admin123
                </div>
            </div>
        </div>

        <!-- Dashboard -->
        <div id="dashboard" class="dashboard">
            <div class="dashboard-header">
                <h1><i class="fas fa-leaf"></i> Admin Panel - ƒê·∫∑c S·∫£n T√¢y B·∫Øc</h1>
                <div style="display: flex; gap: 1rem; margin-top: 1rem; flex-wrap: wrap;">
                    <a href="https://nguyenngocbinh.github.io/DACSANTAYBAC/" target="_blank" class="btn btn-primary" style="display: inline-block; text-decoration: none; text-align: center; width: auto;">
                        <i class="fas fa-external-link-alt"></i> Xem Website
                    </a>
                    <button class="btn btn-success" onclick="exportToExcel()" title="Xu·∫•t file Excel">
                        <i class="fas fa-file-excel"></i> Xu·∫•t Excel
                    </button>
                    <button class="btn btn-info" onclick="openImportModal()" title="Import t·ª´ file Excel/CSV">
                        <i class="fas fa-file-upload"></i> Import Excel
                    </button>
                    <button class="btn btn-secondary" onclick="downloadTemplate()" title="T·∫£i file m·∫´u Excel">
                        <i class="fas fa-download"></i> File M·∫´u
                    </button>
                    <button class="btn btn-danger" onclick="logout()">
                        <i class="fas fa-sign-out-alt"></i> ƒêƒÉng Xu·∫•t
                    </button>
                </div>
            </div>

            <!-- Statistics -->
            <div class="stats-grid">
                <div class="stat-card">
                    <i class="fas fa-boxes"></i>
                    <h3>T·ªïng S·∫£n Ph·∫©m</h3>
                    <p id="totalProducts">21</p>
                </div>
                <div class="stat-card">
                    <i class="fas fa-dollar-sign"></i>
                    <h3>ƒê√£ S·ª≠a Gi√°</h3>
                    <p id="modifiedProducts">0</p>
                </div>
                <div class="stat-card">
                    <i class="fas fa-image"></i>
                    <h3>ƒê√£ S·ª≠a ·∫¢nh</h3>
                    <p id="modifiedImages">0</p>
                </div>
                <div class="stat-card">
                    <i class="fas fa-chart-line"></i>
                    <h3>Gi√° Trung B√¨nh</h3>
                    <p id="averagePrice">0‚Ç´</p>
                </div>
            </div>

            <!-- Products Section -->
            <div class="products-section">
                <div class="section-header">
                    <h2><i class="fas fa-shopping-basket"></i> Qu·∫£n L√Ω S·∫£n Ph·∫©m</h2>
                </div>

                <div class="search-filter">
                    <input type="text" id="searchInput" placeholder="üîç T√¨m ki·∫øm s·∫£n ph·∫©m..." onkeyup="filterProducts()">
                    <select id="categoryFilter" onchange="filterProducts()">
                        <option value="">üè∑Ô∏è T·∫•t c·∫£ danh m·ª•c</option>
                        <option value="D∆∞·ª£c li·ªáu">üåø D∆∞·ª£c li·ªáu</option>
                        <option value="Th·ª±c ph·∫©m">üçØ Th·ª±c ph·∫©m</option>
                        <option value="ƒê·ªì u·ªëng">üçµ ƒê·ªì u·ªëng</option>
                        <option value="Tinh d·∫ßu">üíß Tinh d·∫ßu</option>
                    </select>
                    <button class="btn btn-warning" onclick="resetAllData()" style="width: auto; padding: 10px 20px;">
                        <i class="fas fa-undo"></i> Reset T·∫•t C·∫£
                    </button>
                </div>

                <div id="productsGrid" class="products-grid">
                    <!-- Products will be generated by JavaScript -->
                </div>
            </div>
        </div>
        
        <!-- Edit Product Modal -->
        <div id="editModal" class="edit-modal">
            <div class="edit-content">
                <div class="edit-header">
                    <h3 id="editTitle">Ch·ªânh S·ª≠a S·∫£n Ph·∫©m</h3>
                    <button class="close-btn" onclick="closeEditModal()">&times;</button>
                </div>
                
                <form id="editForm">
                    <div class="form-group">
                        <label>üì¶ T√™n s·∫£n ph·∫©m:</label>
                        <input type="text" id="editName" required>
                    </div>
                    
                    <div class="form-group">
                        <label>üè∑Ô∏è Danh m·ª•c:</label>
                        <select id="editCategory" required>
                            <option value="D∆∞·ª£c li·ªáu">üåø D∆∞·ª£c li·ªáu</option>
                            <option value="Th·ª±c ph·∫©m">üçØ Th·ª±c ph·∫©m</option>
                            <option value="ƒê·ªì u·ªëng">üçµ ƒê·ªì u·ªëng</option>
                            <option value="Tinh d·∫ßu">üíß Tinh d·∫ßu</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label>üí∞ Gi√° s·∫£n ph·∫©m (VNƒê):</label>
                        <input type="number" id="editPrice" required min="1000">
                    </div>
                    
                    <div class="form-group">
                        <label>üìù M√¥ t·∫£:</label>
                        <textarea id="editDescription" rows="3" required></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label>üòä Ch·ªçn emoji:</label>
                        <div class="emoji-picker" id="emojiPicker">
                            <!-- Emojis will be generated by JavaScript -->
                        </div>
                        <input type="hidden" id="editEmoji" required>
                    </div>
                    
                    <div class="form-group">
                        <label>üñºÔ∏è URL ·∫£nh (t√πy ch·ªçn):</label>
                        <input type="url" id="editImageUrl" placeholder="https://example.com/image.jpg">
                        <small style="color: #666;">ƒê·ªÉ tr·ªëng n·∫øu ch·ªâ s·ª≠ d·ª•ng emoji</small>
                    </div>
                    
                    <div style="display: flex; gap: 1rem;">
                        <button type="submit" class="btn" style="flex: 1;">
                            <i class="fas fa-save"></i> L∆∞u Thay ƒê·ªïi
                        </button>
                        <button type="button" class="btn btn-danger" onclick="closeEditModal()" style="flex: 1;">
                            <i class="fas fa-times"></i> H·ªßy
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Import Excel Modal -->
    <div id="importModal" class="login-modal" style="display: none;">
        <div class="login-content" style="width: 500px;">
            <div class="login-header">
                <h2><i class="fas fa-file-upload"></i> Import D·ªØ Li·ªáu Excel/CSV</h2>
                <button class="close-btn" onclick="closeImportModal()" style="position: absolute; top: 15px; right: 15px;">√ó</button>
            </div>
            
            <div class="form-group">
                <label for="importFile">Ch·ªçn file Excel (.xlsx) ho·∫∑c CSV (.csv):</label>
                <input type="file" id="importFile" accept=".xlsx,.xls,.csv" class="form-control">
                <small style="color: #666; margin-top: 5px; display: block;">
                    File ph·∫£i c√≥ c·∫•u tr√∫c: ID, T√™n s·∫£n ph·∫©m, Danh m·ª•c, Gi√° g·ªëc, Gi√° hi·ªán t·∫°i, H√¨nh ·∫£nh, M√¥ t·∫£, ƒê∆°n v·ªã
                </small>
            </div>
            
            <div class="form-group">
                <label>
                    <input type="checkbox" id="overwriteData" style="width: auto; margin-right: 10px;">
                    Ghi ƒë√® d·ªØ li·ªáu hi·ªán t·∫°i (n·∫øu kh√¥ng ch·ªçn s·∫Ω ch·ªâ c·∫≠p nh·∫≠t c√°c s·∫£n ph·∫©m c√≥ s·∫µn)
                </label>
            </div>
            
            <div style="display: flex; gap: 10px;">
                <button class="btn btn-success" onclick="processImportFile()" style="flex: 1;">
                    <i class="fas fa-upload"></i> Import D·ªØ Li·ªáu
                </button>
                <button class="btn btn-secondary" onclick="closeImportModal()" style="flex: 1;">
                    <i class="fas fa-times"></i> H·ªßy
                </button>
            </div>
        </div>
    </div>

    <!-- Status Message -->
    <div id="statusMessage" class="status-message"></div>

    <!-- Include SheetJS for Excel processing -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

    <script>
        // Products data
        const products = [
            { id: 1, name: "Tam th·∫•t kh√¥", price: 120000, category: "D∆∞·ª£c li·ªáu", emoji: "üåø", description: "Tam th·∫•t kh√¥ ch·∫•t l∆∞·ª£ng cao t·ª´ n√∫i r·ª´ng T√¢y B·∫Øc", imageUrl: "" },
            { id: 2, name: "M·∫≠t ong r·ª´ng", price: 250000, category: "Th·ª±c ph·∫©m", emoji: "üçØ", description: "M·∫≠t ong r·ª´ng nguy√™n ch·∫•t, kh√¥ng pha tr·ªôn", imageUrl: "" },
            { id: 3, name: "H·∫°t d·∫ª n∆∞·ªõng", price: 80000, category: "Th·ª±c ph·∫©m", emoji: "üå∞", description: "H·∫°t d·∫ª n∆∞·ªõng th∆°m ngon, gi√≤n tan", imageUrl: "" },
            { id: 4, name: "Ch√® shan tuy·∫øt", price: 300000, category: "ƒê·ªì u·ªëng", emoji: "üçµ", description: "Ch√® shan tuy·∫øt c·ªï th√π, h∆∞∆°ng v·ªã ƒë·∫∑c bi·ªát", imageUrl: "" },
            { id: 5, name: "N·∫•m linh chi", price: 180000, category: "D∆∞·ª£c li·ªáu", emoji: "üçÑ", description: "N·∫•m linh chi r·ª´ng, b·ªï d∆∞∆°ng tƒÉng s·ª©c kh·ªèe", imageUrl: "" },
            { id: 6, name: "S√¢m Ng·ªçc Linh", price: 450000, category: "D∆∞·ª£c li·ªáu", emoji: "üå±", description: "S√¢m Ng·ªçc Linh qu√Ω hi·∫øm t·ª´ ƒë·ªânh n√∫i cao", imageUrl: "" },
            { id: 7, name: "M√®o v·∫°c m·∫≠t", price: 95000, category: "Th·ª±c ph·∫©m", emoji: "ü•ú", description: "H·∫°t m√®o v·∫°c m·∫≠t th∆°m ngon, b√πi b√©o", imageUrl: "" },
            { id: 8, name: "Tr√† hoa v√†ng", price: 85000, category: "ƒê·ªì u·ªëng", emoji: "üåº", description: "Tr√† hoa v√†ng thanh m√°t, gi·∫£i nhi·ªát", imageUrl: "" },
            { id: 9, name: "M·∫≠t ong cao su", price: 320000, category: "Th·ª±c ph·∫©m", emoji: "üçØ", description: "M·∫≠t ong cao su nguy√™n ch·∫•t, v·ªã ng·ªçt ƒë·∫≠m ƒë√†", imageUrl: "" },
            { id: 10, name: "C·ªß m√†i t√°o m√®o", price: 75000, category: "D∆∞·ª£c li·ªáu", emoji: "ü•î", description: "C·ªß m√†i t√°o m√®o ch·ªØa ƒëau d·∫° d√†y", imageUrl: "" },
            { id: 11, name: "Tinh d·∫ßu s·∫£", price: 110000, category: "Tinh d·∫ßu", emoji: "üíß", description: "Tinh d·∫ßu s·∫£ nguy√™n ch·∫•t, ƒëu·ªïi mu·ªói hi·ªáu qu·∫£", imageUrl: "" },
            { id: 12, name: "N·∫•m r∆°m r·ª´ng", price: 65000, category: "Th·ª±c ph·∫©m", emoji: "üçÑ", description: "N·∫•m r∆°m r·ª´ng t∆∞∆°i ngon, gi√†u dinh d∆∞·ª°ng", imageUrl: "" },
            { id: 13, name: "Ch√® t√¢m sen", price: 140000, category: "ƒê·ªì u·ªëng", emoji: "üçµ", description: "Ch√® t√¢m sen thanh ƒë·∫°m, d·ªÖ u·ªëng", imageUrl: "" },
            { id: 14, name: "Tinh d·∫ßu b·∫°c h√†", price: 90000, category: "Tinh d·∫ßu", emoji: "üåø", description: "Tinh d·∫ßu b·∫°c h√† m√°t l·∫°nh, th∆°m d·ªãu", imageUrl: "" },
            { id: 15, name: "N·∫•m ƒë√¥ng c√¥", price: 220000, category: "Th·ª±c ph·∫©m", emoji: "üçÑ", description: "N·∫•m ƒë√¥ng c√¥ kh√¥ cao c·∫•p, th∆°m ngon", imageUrl: "" },
            { id: 16, name: "ƒê·∫≠u c√¥ ve", price: 55000, category: "Th·ª±c ph·∫©m", emoji: "ü´ò", description: "ƒê·∫≠u c√¥ ve rang gi√≤n, b·ªï d∆∞·ª°ng", imageUrl: "" },
            { id: 17, name: "Tr√† ∆∞·ªõp hoa sen", price: 160000, category: "ƒê·ªì u·ªëng", emoji: "ü™∑", description: "Tr√† ∆∞·ªõp hoa sen th∆°m n·ª©c, cao c·∫•p", imageUrl: "" },
            { id: 18, name: "Tinh d·∫ßu qu·∫ø", price: 130000, category: "Tinh d·∫ßu", emoji: "üåø", description: "Tinh d·∫ßu qu·∫ø ·∫•m √°p, kh√°ng khu·∫©n t·ªët", imageUrl: "" },
            { id: 19, name: "M·ªôc nhƒ© r·ª´ng", price: 45000, category: "Th·ª±c ph·∫©m", emoji: "üçÑ", description: "M·ªôc nhƒ© r·ª´ng t·ª± nhi√™n, gi√≤n ngon", imageUrl: "" },
            { id: 20, name: "Ch√® b√∫p non", price: 185000, category: "ƒê·ªì u·ªëng", emoji: "üçÉ", description: "Ch√® b√∫p non cao c·∫•p, v·ªã thanh ng·ªçt", imageUrl: "" },
            { id: 21, name: "Tinh d·∫ßu tr√†m", price: 100000, category: "Tinh d·∫ßu", emoji: "üåø", description: "Tinh d·∫ßu tr√†m ch·ªØa c·∫£m l·∫°nh hi·ªáu qu·∫£", imageUrl: "" }
        ];

        // Available emojis for products
        const availableEmojis = [
            'üåø', 'üçØ', 'üå∞', 'üçµ', 'üçÑ', 'üå±', 'ü•ú', 'üåº', 'ü•î', 'üíß', 'ü´ò', 'ü™∑', 'üçÉ',
            'üå∏', 'üå∫', 'üåª', 'üå∑', 'üåπ', 'ü•Ä', 'üåæ', 'üåø', 'üçÄ', 'üçÅ', 'üçÇ', 'üçÉ',
            'ü••', 'ü•ë', 'üçä', 'üçã', 'üçå', 'üçç', 'ü•≠', 'üçé', 'üçè', 'üçê', 'üçë', 'üçí',
            'üçì', 'ü´ê', 'üçá', 'üçà', 'üçâ', 'üçÖ', 'ü´í', 'üå∂Ô∏è', 'ü´ë', 'ü•í', 'ü•¨', 'ü•¶',
            'üçÜ', 'ü•ï', 'üåΩ', 'ü´ò', 'ü•î', 'üç†', 'ü´ú', 'üçõ', 'üçú', 'üçù', 'üçû', 'ü•®'
        ];

        let currentProducts = [...products];
        let isLoggedIn = false;
        let currentEditingId = null;

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ Enhanced Admin Panel Loading...');
            initializeAdmin();
        });

        function initializeAdmin() {
            setupEventListeners();
            generateEmojiPicker();
            checkLoginStatus();
        }

        function setupEventListeners() {
            const loginForm = document.getElementById('loginForm');
            if (loginForm) {
                loginForm.addEventListener('submit', handleLogin);
            }
            
            const editForm = document.getElementById('editForm');
            if (editForm) {
                editForm.addEventListener('submit', handleEditSubmit);
            }
        }

        function generateEmojiPicker() {
            const emojiPicker = document.getElementById('emojiPicker');
            emojiPicker.innerHTML = '';
            
            availableEmojis.forEach(emoji => {
                const button = document.createElement('button');
                button.type = 'button';
                button.className = 'emoji-option';
                button.textContent = emoji;
                button.onclick = () => selectEmoji(emoji, button);
                emojiPicker.appendChild(button);
            });
        }

        function selectEmoji(emoji, button) {
            // Remove previous selection
            document.querySelectorAll('.emoji-option').forEach(btn => {
                btn.classList.remove('selected');
            });
            
            // Select current emoji
            button.classList.add('selected');
            document.getElementById('editEmoji').value = emoji;
        }

        function checkLoginStatus() {
            const savedLogin = localStorage.getItem('adminLoggedIn');
            if (savedLogin === 'true') {
                showDashboard();
            } else {
                showLogin();
            }
        }

        function handleLogin(e) {
            e.preventDefault();
            
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            console.log('Login attempt:', username, password.length);
            
            if (username === 'admin' && password === 'admin123') {
                localStorage.setItem('adminLoggedIn', 'true');
                showStatusMessage('‚úÖ ƒêƒÉng nh·∫≠p th√†nh c√¥ng!', 'success');
                setTimeout(() => {
                    showDashboard();
                }, 1000);
            } else {
                showStatusMessage('‚ùå Sai t√™n ƒëƒÉng nh·∫≠p ho·∫∑c m·∫≠t kh·∫©u!', 'error');
            }
        }

        function showLogin() {
            document.getElementById('loginModal').style.display = 'flex';
            document.getElementById('dashboard').classList.remove('active');
            isLoggedIn = false;
        }

        function showDashboard() {
            document.getElementById('loginModal').style.display = 'none';
            document.getElementById('dashboard').classList.add('active');
            isLoggedIn = true;
            loadProducts();
            updateStatistics();
        }

        function logout() {
            localStorage.removeItem('adminLoggedIn');
            showStatusMessage('üëã ƒê√£ ƒëƒÉng xu·∫•t!', 'success');
            setTimeout(() => {
                showLogin();
                document.getElementById('loginForm').reset();
            }, 1000);
        }

        function loadProducts() {
            const grid = document.getElementById('productsGrid');
            grid.innerHTML = '';
            
            currentProducts.forEach(product => {
                const currentPrice = getCurrentPrice(product.id);
                const currentData = getCurrentProductData(product.id);
                const hasChangedPrice = currentPrice !== product.price;
                const hasChangedImage = currentData.emoji !== product.emoji || currentData.imageUrl !== product.imageUrl;
                const hasChangedInfo = currentData.name !== product.name || currentData.description !== product.description;
                
                const displayEmoji = currentData.emoji || product.emoji;
                const displayImageUrl = currentData.imageUrl || product.imageUrl;
                
                const productCard = `
                    <div class="product-card" data-category="${currentData.category || product.category}" data-name="${(currentData.name || product.name).toLowerCase()}">
                        <div class="product-header">
                            <h4>${currentData.name || product.name}</h4>
                            <span class="product-emoji">${displayEmoji}</span>
                        </div>
                        
                        <div class="product-image-section">
                            <div class="product-image-preview">
                                ${displayImageUrl ? `<img src="${displayImageUrl}" alt="${product.name}" style="width: 100%; height: 100%; object-fit: cover; border-radius: 8px;" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                                <span style="display: none; font-size: 2.5rem;">${displayEmoji}</span>` : displayEmoji}
                            </div>
                            ${displayImageUrl ? `<div class="image-url-display">${displayImageUrl}</div>` : '<div class="image-url-display">Ch·ªâ s·ª≠ d·ª•ng emoji</div>'}
                        </div>
                        
                        <div class="product-info">
                            <p><strong>Danh m·ª•c:</strong> ${currentData.category || product.category}</p>
                            <p><strong>M√¥ t·∫£:</strong> ${currentData.description || product.description}</p>
                        </div>
                        
                        <div class="price-section">
                            <div class="price-display">
                                <span class="original-price">Gi√° g·ªëc: ${formatPrice(product.price)}</span>
                                <span class="current-price">Hi·ªán t·∫°i: ${formatPrice(currentPrice)}</span>
                            </div>
                            ${hasChangedPrice ? '<small style="color: #28a745; font-weight: bold;">üí∞ Gi√° ƒë√£ thay ƒë·ªïi</small>' : ''}
                            ${hasChangedImage ? '<small style="color: #6f42c1; font-weight: bold;">üñºÔ∏è ·∫¢nh ƒë√£ thay ƒë·ªïi</small>' : ''}
                            ${hasChangedInfo ? '<small style="color: #fd7e14; font-weight: bold;">üìù Th√¥ng tin ƒë√£ thay ƒë·ªïi</small>' : ''}
                        </div>
                        
                        <div class="price-edit">
                            <input type="number" class="price-input" id="price${product.id}" placeholder="${currentPrice}" value="${currentPrice}">
                            <button class="btn-sm btn-edit" onclick="updatePrice(${product.id})">
                                <i class="fas fa-save"></i>
                            </button>
                        </div>
                        
                        <div class="product-actions">
                            <button class="btn-sm btn-edit" onclick="openEditModal(${product.id})">
                                <i class="fas fa-edit"></i> Ch·ªânh s·ª≠a
                            </button>
                            <button class="btn-sm btn-reset" onclick="resetProduct(${product.id})">
                                <i class="fas fa-undo"></i> Reset
                            </button>
                        </div>
                    </div>
                `;
                
                grid.innerHTML += productCard;
            });
        }

        function getCurrentPrice(productId) {
            const savedPrice = localStorage.getItem(`product_${productId}_price`);
            if (savedPrice) {
                return parseInt(savedPrice);
            }
            const product = products.find(p => p.id === productId);
            return product ? product.price : 0;
        }

        function getCurrentProductData(productId) {
            const savedData = localStorage.getItem(`product_${productId}_data`);
            if (savedData) {
                return JSON.parse(savedData);
            }
            const product = products.find(p => p.id === productId);
            return product ? { ...product } : {};
        }

        function updatePrice(productId) {
            const input = document.getElementById(`price${productId}`);
            const newPrice = parseInt(input.value);
            
            if (isNaN(newPrice) || newPrice <= 0) {
                showStatusMessage('‚ùå Vui l√≤ng nh·∫≠p gi√° h·ª£p l·ªá!', 'error');
                return;
            }
            
            localStorage.setItem(`product_${productId}_price`, newPrice);
            
            const product = products.find(p => p.id === productId);
            showStatusMessage(`‚úÖ ƒê√£ c·∫≠p nh·∫≠t gi√° ${product.name} th√†nh ${formatPrice(newPrice)}`, 'success');
            
            loadProducts();
            updateStatistics();
        }

        function openEditModal(productId) {
            currentEditingId = productId;
            const product = products.find(p => p.id === productId);
            const currentData = getCurrentProductData(productId);
            
            document.getElementById('editTitle').textContent = `Ch·ªânh s·ª≠a: ${product.name}`;
            document.getElementById('editName').value = currentData.name || product.name;
            document.getElementById('editCategory').value = currentData.category || product.category;
            document.getElementById('editPrice').value = getCurrentPrice(productId);
            document.getElementById('editDescription').value = currentData.description || product.description;
            document.getElementById('editEmoji').value = currentData.emoji || product.emoji;
            document.getElementById('editImageUrl').value = currentData.imageUrl || product.imageUrl || '';
            
            // Select current emoji in picker
            document.querySelectorAll('.emoji-option').forEach(btn => {
                btn.classList.remove('selected');
                if (btn.textContent === (currentData.emoji || product.emoji)) {
                    btn.classList.add('selected');
                }
            });
            
            document.getElementById('editModal').classList.add('active');
        }

        function closeEditModal() {
            document.getElementById('editModal').classList.remove('active');
            currentEditingId = null;
        }

        function handleEditSubmit(e) {
            e.preventDefault();
            
            if (!currentEditingId) return;
            
            const newData = {
                name: document.getElementById('editName').value,
                category: document.getElementById('editCategory').value,
                description: document.getElementById('editDescription').value,
                emoji: document.getElementById('editEmoji').value,
                imageUrl: document.getElementById('editImageUrl').value
            };
            
            const newPrice = parseInt(document.getElementById('editPrice').value);
            
            // Save product data
            localStorage.setItem(`product_${currentEditingId}_data`, JSON.stringify(newData));
            
            // Save price
            localStorage.setItem(`product_${currentEditingId}_price`, newPrice);
            
            const originalProduct = products.find(p => p.id === currentEditingId);
            showStatusMessage(`‚úÖ ƒê√£ c·∫≠p nh·∫≠t th√¥ng tin ${originalProduct.name}`, 'success');
            
            closeEditModal();
            loadProducts();
            updateStatistics();
        }

        function resetProduct(productId) {
            if (confirm('B·∫°n c√≥ ch·∫Øc mu·ªën kh√¥i ph·ª•c s·∫£n ph·∫©m n√†y v·ªÅ tr·∫°ng th√°i ban ƒë·∫ßu?')) {
                localStorage.removeItem(`product_${productId}_price`);
                localStorage.removeItem(`product_${productId}_data`);
                
                const product = products.find(p => p.id === productId);
                showStatusMessage(`üîÑ ƒê√£ kh√¥i ph·ª•c "${product.name}" v·ªÅ tr·∫°ng th√°i ban ƒë·∫ßu`, 'success');
                
                loadProducts();
                updateStatistics();
            }
        }

        function resetAllData() {
            if (confirm('B·∫°n c√≥ ch·∫Øc mu·ªën kh√¥i ph·ª•c T·∫§T C·∫¢ s·∫£n ph·∫©m v·ªÅ tr·∫°ng th√°i ban ƒë·∫ßu?')) {
                products.forEach(product => {
                    localStorage.removeItem(`product_${product.id}_price`);
                    localStorage.removeItem(`product_${product.id}_data`);
                });
                
                showStatusMessage('üîÑ ƒê√£ kh√¥i ph·ª•c t·∫•t c·∫£ s·∫£n ph·∫©m v·ªÅ tr·∫°ng th√°i ban ƒë·∫ßu!', 'success');
                loadProducts();
                updateStatistics();
            }
        }

        function filterProducts() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const categoryFilter = document.getElementById('categoryFilter').value;
            
            const cards = document.querySelectorAll('.product-card');
            
            cards.forEach(card => {
                const name = card.getAttribute('data-name');
                const category = card.getAttribute('data-category');
                
                const matchesSearch = name.includes(searchTerm);
                const matchesCategory = !categoryFilter || category === categoryFilter;
                
                if (matchesSearch && matchesCategory) {
                    card.style.display = 'block';
                } else {
                    card.style.display = 'none';
                }
            });
        }

        function updateStatistics() {
            let modifiedPrices = 0;
            let modifiedImages = 0;
            let totalPrice = 0;
            
            products.forEach(product => {
                const currentPrice = getCurrentPrice(product.id);
                const currentData = getCurrentProductData(product.id);
                
                totalPrice += currentPrice;
                
                if (currentPrice !== product.price) {
                    modifiedPrices++;
                }
                
                if (currentData.emoji !== product.emoji || 
                    currentData.imageUrl !== product.imageUrl ||
                    currentData.name !== product.name ||
                    currentData.description !== product.description) {
                    modifiedImages++;
                }
            });
            
            document.getElementById('modifiedProducts').textContent = modifiedPrices;
            document.getElementById('modifiedImages').textContent = modifiedImages;
            document.getElementById('averagePrice').textContent = formatPrice(Math.round(totalPrice / products.length));
        }

        function formatPrice(price) {
            return new Intl.NumberFormat('vi-VN').format(price) + '‚Ç´';
        }

        function showStatusMessage(message, type) {
            const statusEl = document.getElementById('statusMessage');
            statusEl.textContent = message;
            statusEl.className = `status-message ${type} show`;
            
            setTimeout(() => {
                statusEl.classList.remove('show');
            }, 4000);
        }

        // Excel Export/Import Functions
        function exportToExcel() {
            const exportData = currentProducts.map(product => {
                const currentPrice = getCurrentPrice(product.id);
                const currentData = getCurrentProductData(product.id);
                
                return {
                    'ID': product.id,
                    'T√™n s·∫£n ph·∫©m': currentData.name || product.name,
                    'Danh m·ª•c': currentData.category || product.category,
                    'Gi√° g·ªëc': product.price,
                    'Gi√° hi·ªán t·∫°i': currentPrice,
                    'H√¨nh ·∫£nh': currentData.imageUrl || currentData.emoji || product.emoji,
                    'M√¥ t·∫£': currentData.description || product.description,
                    'ƒê∆°n v·ªã': product.unit || ''
                };
            });

            const ws = XLSX.utils.json_to_sheet(exportData);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "S·∫£n ph·∫©m");
            
            // Auto adjust column width
            const colWidths = [];
            const header = Object.keys(exportData[0]);
            header.forEach((key, i) => {
                const maxLength = Math.max(
                    key.length,
                    ...exportData.map(row => String(row[key] || '').length)
                );
                colWidths[i] = { width: Math.min(maxLength + 2, 50) };
            });
            ws['!cols'] = colWidths;
            
            const fileName = `dacsantaybac_products_${new Date().toISOString().split('T')[0]}.xlsx`;
            XLSX.writeFile(wb, fileName);
            
            showStatus('ƒê√£ xu·∫•t file Excel th√†nh c√¥ng!', 'success');
        }

        function downloadTemplate() {
            const templateData = [
                {
                    'ID': 1,
                    'T√™n s·∫£n ph·∫©m': 'Tam th·∫•t kh√¥',
                    'Danh m·ª•c': 'herbal',
                    'Gi√° g·ªëc': 120000,
                    'Gi√° hi·ªán t·∫°i': 120000,
                    'H√¨nh ·∫£nh': 'üåø',
                    'M√¥ t·∫£': 'Tam th·∫•t kh√¥ cao c·∫•p t·ª´ T√¢y B·∫Øc',
                    'ƒê∆°n v·ªã': '100g'
                },
                {
                    'ID': 2,
                    'T√™n s·∫£n ph·∫©m': 'M·∫≠t ong r·ª´ng',
                    'Danh m·ª•c': 'food',
                    'Gi√° g·ªëc': 250000,
                    'Gi√° hi·ªán t·∫°i': 250000,
                    'H√¨nh ·∫£nh': 'images/mat-ong-rung.jpg',
                    'M√¥ t·∫£': 'M·∫≠t ong r·ª´ng nguy√™n ch·∫•t',
                    'ƒê∆°n v·ªã': '500ml'
                }
            ];

            const ws = XLSX.utils.json_to_sheet(templateData);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "Template");
            
            // Add instructions sheet
            const instructions = [
                ['H∆Ø·ªöNG D·∫™N S·ª¨ D·ª§NG FILE EXCEL'],
                [''],
                ['1. C·ªôt ID: S·ªë th·ª© t·ª± s·∫£n ph·∫©m (b·∫Øt bu·ªôc)'],
                ['2. C·ªôt T√™n s·∫£n ph·∫©m: T√™n hi·ªÉn th·ªã c·ªßa s·∫£n ph·∫©m'],
                ['3. C·ªôt Danh m·ª•c: herbal (d∆∞·ª£c li·ªáu), food (th·ª±c ph·∫©m), oil (tinh d·∫ßu), drink (ƒë·ªì u·ªëng)'],
                ['4. C·ªôt Gi√° g·ªëc: Gi√° ban ƒë·∫ßu c·ªßa s·∫£n ph·∫©m'],
                ['5. C·ªôt Gi√° hi·ªán t·∫°i: Gi√° b√°n hi·ªán t·∫°i'],
                ['6. C·ªôt H√¨nh ·∫£nh: Link ·∫£nh ho·∫∑c emoji (v√≠ d·ª•: images/abc.jpg ho·∫∑c üåø)'],
                ['7. C·ªôt M√¥ t·∫£: M√¥ t·∫£ chi ti·∫øt s·∫£n ph·∫©m'],
                ['8. C·ªôt ƒê∆°n v·ªã: ƒê∆°n v·ªã b√°n (v√≠ d·ª•: 100g, 1kg, 500ml)'],
                [''],
                ['CH√ö √ù:'],
                ['- File ph·∫£i c√≥ ƒë√∫ng t√™n c·ªôt nh∆∞ m·∫´u'],
                ['- ID ph·∫£i l√† s·ªë v√† duy nh·∫•t'],
                ['- Gi√° ph·∫£i l√† s·ªë'],
                ['- Danh m·ª•c ch·ªâ ch·∫•p nh·∫≠n: herbal, food, oil, drink']
            ];
            
            const wsInstructions = XLSX.utils.aoa_to_sheet(instructions);
            XLSX.utils.book_append_sheet(wb, wsInstructions, "H∆∞·ªõng d·∫´n");
            
            XLSX.writeFile(wb, 'template_dacsantaybac_products.xlsx');
            showStatus('ƒê√£ t·∫£i file m·∫´u Excel!', 'info');
        }

        function openImportModal() {
            document.getElementById('importModal').style.display = 'flex';
        }

        function closeImportModal() {
            document.getElementById('importModal').style.display = 'none';
            document.getElementById('importFile').value = '';
            document.getElementById('overwriteData').checked = false;
        }

        function processImportFile() {
            const fileInput = document.getElementById('importFile');
            const file = fileInput.files[0];
            
            if (!file) {
                showStatus('Vui l√≤ng ch·ªçn file ƒë·ªÉ import!', 'error');
                return;
            }

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, { type: 'array' });
                    const sheetName = workbook.SheetNames[0];
                    const worksheet = workbook.Sheets[sheetName];
                    const jsonData = XLSX.utils.sheet_to_json(worksheet);
                    
                    if (jsonData.length === 0) {
                        showStatus('File kh√¥ng c√≥ d·ªØ li·ªáu!', 'error');
                        return;
                    }
                    
                    // Validate required columns
                    const requiredColumns = ['ID', 'T√™n s·∫£n ph·∫©m', 'Danh m·ª•c', 'Gi√° g·ªëc', 'Gi√° hi·ªán t·∫°i'];
                    const firstRow = jsonData[0];
                    const missingColumns = requiredColumns.filter(col => !(col in firstRow));
                    
                    if (missingColumns.length > 0) {
                        showStatus(`File thi·∫øu c√°c c·ªôt b·∫Øt bu·ªôc: ${missingColumns.join(', ')}`, 'error');
                        return;
                    }
                    
                    importProducts(jsonData);
                    
                } catch (error) {
                    console.error('Error reading file:', error);
                    showStatus('L·ªói ƒë·ªçc file! Vui l√≤ng ki·ªÉm tra format file.', 'error');
                }
            };
            
            reader.readAsArrayBuffer(file);
        }

        function importProducts(importData) {
            const overwrite = document.getElementById('overwriteData').checked;
            let imported = 0;
            let updated = 0;
            let errors = 0;
            
            importData.forEach(row => {
                try {
                    const id = parseInt(row['ID']);
                    const name = row['T√™n s·∫£n ph·∫©m']?.toString().trim();
                    const category = row['Danh m·ª•c']?.toString().trim();
                    const originalPrice = parseInt(row['Gi√° g·ªëc']);
                    const currentPrice = parseInt(row['Gi√° hi·ªán t·∫°i']);
                    const image = row['H√¨nh ·∫£nh']?.toString().trim() || '';
                    const description = row['M√¥ t·∫£']?.toString().trim() || '';
                    const unit = row['ƒê∆°n v·ªã']?.toString().trim() || '';
                    
                    // Validate data
                    if (!id || !name || !category || isNaN(originalPrice) || isNaN(currentPrice)) {
                        errors++;
                        return;
                    }
                    
                    // Check valid category
                    const validCategories = ['herbal', 'food', 'oil', 'drink'];
                    if (!validCategories.includes(category)) {
                        errors++;
                        return;
                    }
                    
                    const existingIndex = currentProducts.findIndex(p => p.id === id);
                    
                    if (existingIndex >= 0) {
                        // Update existing product
                        if (overwrite) {
                            currentProducts[existingIndex] = {
                                id: id,
                                name: name,
                                category: category,
                                price: originalPrice,
                                emoji: image.startsWith('images/') ? 'üì¶' : image,
                                description: description,
                                unit: unit,
                                imageUrl: image.startsWith('images/') ? image : ''
                            };
                        }
                        
                        // Update current price and data
                        localStorage.setItem(`product_${id}_price`, currentPrice.toString());
                        localStorage.setItem(`product_${id}_data`, JSON.stringify({
                            name: name,
                            category: category,
                            emoji: image.startsWith('images/') ? 'üì¶' : image,
                            imageUrl: image.startsWith('images/') ? image : '',
                            description: description
                        }));
                        
                        updated++;
                    } else if (overwrite) {
                        // Add new product
                        const newProduct = {
                            id: id,
                            name: name,
                            category: category,
                            price: originalPrice,
                            emoji: image.startsWith('images/') ? 'üì¶' : image,
                            description: description,
                            unit: unit,
                            imageUrl: image.startsWith('images/') ? image : ''
                        };
                        
                        currentProducts.push(newProduct);
                        
                        // Set current price
                        localStorage.setItem(`product_${id}_price`, currentPrice.toString());
                        localStorage.setItem(`product_${id}_data`, JSON.stringify({
                            name: name,
                            category: category,
                            emoji: image.startsWith('images/') ? 'üì¶' : image,
                            imageUrl: image.startsWith('images/') ? image : '',
                            description: description
                        }));
                        
                        imported++;
                    }
                    
                } catch (error) {
                    console.error('Error processing row:', row, error);
                    errors++;
                }
            });
            
            // Save and refresh
            localStorage.setItem('products', JSON.stringify(currentProducts));
            loadProducts();
            updateStatistics();
            closeImportModal();
            
            let message = `Import ho√†n th√†nh! `;
            if (imported > 0) message += `Th√™m m·ªõi: ${imported} s·∫£n ph·∫©m. `;
            if (updated > 0) message += `C·∫≠p nh·∫≠t: ${updated} s·∫£n ph·∫©m. `;
            if (errors > 0) message += `L·ªói: ${errors} d√≤ng.`;
            
            showStatus(message, imported > 0 || updated > 0 ? 'success' : 'warning');
        }

        console.log('‚úÖ Enhanced Admin Panel with Image Management Ready!');
    </script>
</body>
</html>
